# doken [![CI Status](https://github.com/yishn/doken/workflows/CI/badge.svg?branch=master)](https://github.com/yishn/doken/actions)

A minimalistic, general purpose tokenizer generator.

## Usage

Use npm to install:

```
$ npm install doken
```

Import doken and create a tokenizer with regular expression rules:

```js
const {createTokenizer, regexRule} = require('doken')

const tokenizeJSON = createTokenizer({
  rules: [
    regexRule('_whitespace', /^\s+/),
    regexRule('brace', /^[{}]/),
    regexRule('bracket', /^[\[\]]/),
    regexRule('colon', /^:/),
    regexRule('comma', /^,/),
    regexRule('string', /^"([^"\n\\]|\\[^\n])*"/),
    regexRule('number', /^(-|\+)?\d+(.\d+)?/),
    regexRule('boolean', /^(true|false)(?!\w)/),
    regexRule('null', /^null(?!\w)/)
  ]
})

let tokens = tokenizeJSON("{a: 'Hello World!'}")

console.log([...tokens])
```

## API

### Rule object

A rule object contains the following fields:

- `type` `<string>` - The type of the token this rule generates.
  If `type` starts with an underscore `_`, the token will not be emitted by the tokenizer.
- `match` `<Function>` - A function with the following signature:

  ```js
  (input: <string>) -> null | {
    length: <number>,
    value?: <any>
  }
  ```

  This function will try to get the first token of `input` if applicable. Return `null` if
  `input` doesn't start with a token with the given `type`, otherwise return an object.

  The first `length` characters of `input` will be the matched token. You can optionally
  return a `value` which can contain any data that will be attached to the token. If `value`
  is not given, it will default to the first `length` characters of `input`.

### Token object

A token will be represented by an object with the following fields:

- `type` `<string>` | `null` - The type of the token or `null` if no given rules match
  the input.
- `length` `<number>` - The length of the token.
- `value` `<any>` - The `value` generated by the rule.
- `pos` `<number>` - The zero-based position of the first character of the token.
- `row` `<number>` - The zero-based row of the first character of the token.
- `col` `<number>` - The zero-based column of the first character of the token.

### `doken.createTokenizer(options)`

- `options` `<object>`
  - `rules` `<Array>`
- Returns: [`<IterableIterator<Token>>`](#token-object)

### `doken.regexRule(type, regex[, value])`

- `type` `<string>`
- `regex` [`<RegExp>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp)
- `value` `<Function>`
- Returns: [`<Rule>`](#rule-object)
